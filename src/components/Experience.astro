---
import { translations } from "../i18n";
import ExperienceScroll from "./ExperienceScroll";

const { lang = "en" } = Astro.props;
const t = translations[lang as "en" | "es"].experience;
const experiences = t.items;
---

<section class="experience" id="experience">
    <div class="experience-bg experience-bg-1" aria-hidden="true"></div>
    <div class="experience-bg experience-bg-2" aria-hidden="true"></div>
    <div class="experience-grain" aria-hidden="true"></div>

    <div class="container experience-container !max-w-full">
        <div class="experience-header reveal">
            <p
                class="section-label experience-label"
                data-i18n="experience.label"
            >
                {t.label}
            </p>
            <h2 class="section-title experience-title">
                {t.title}
                <span class="gradient-text"> {t.title_accent || "Impact"}</span>
            </h2>
            <p
                class="section-subtitle experience-subtitle"
                data-i18n="experience.subtitle"
            >
                {t.subtitle}
            </p>
        </div>

        <!-- Performance: render timeline as static HTML to avoid React island hydration on /experience -->
        <ExperienceScroll items={experiences} lang={lang} />
    </div>
</section>

<style>
    .experience {
        padding: clamp(5rem, 8vw, 8rem) 0 clamp(4rem, 6vw, 6.5rem);
        overflow: hidden;
        position: relative;
        isolation: isolate;
    }

    .experience-bg {
        position: absolute;
        inset: 0;
        z-index: -3;
        pointer-events: none;
    }

    .experience-bg-1 {
        background:
            radial-gradient(
                circle at 8% 20%,
                rgba(31, 115, 183, 0.24) 0,
                rgba(31, 115, 183, 0) 36%
            ),
            radial-gradient(
                circle at 92% 14%,
                rgba(20, 184, 166, 0.2) 0,
                rgba(20, 184, 166, 0) 30%
            ),
            radial-gradient(
                circle at 50% 105%,
                rgba(245, 158, 11, 0.16) 0,
                rgba(245, 158, 11, 0) 42%
            );
        filter: blur(2px);
        animation: experience-float-1 24s ease-in-out infinite alternate;
    }

    .experience-bg-2 {
        background:
            linear-gradient(
                135deg,
                rgba(13, 24, 40, 0.42) 0%,
                rgba(8, 15, 30, 0.1) 42%,
                rgba(7, 20, 35, 0.36) 100%
            ),
            conic-gradient(
                from 200deg at 50% 50%,
                rgba(31, 115, 183, 0.1),
                rgba(14, 116, 144, 0.14),
                rgba(245, 158, 11, 0.09),
                rgba(31, 115, 183, 0.1)
            );
        opacity: 0.72;
        mix-blend-mode: screen;
        animation: experience-hue-pan 26s linear infinite;
    }

    .experience-grain {
        position: absolute;
        inset: 0;
        z-index: -2;
        pointer-events: none;
        background-image: radial-gradient(
            rgba(255, 255, 255, 0.08) 0.5px,
            transparent 0.5px
        );
        background-size: 3px 3px;
        opacity: 0.06;
    }

    .experience-container {
        position: relative;
        z-index: 2;
        max-width: 100%;
        padding: 0 0.75rem;
    }

    .experience-header {
        text-align: center;
        margin-bottom: clamp(2rem, 5vw, 3.5rem);
        padding: 0 clamp(0.75rem, 2vw, 2rem);
    }

    .experience-label {
        color: #8fb6d6;
    }

    .experience-title {
        font-size: clamp(2.3rem, 7vw, 4.8rem);
        font-weight: 800;
        letter-spacing: -0.04em;
        margin-bottom: 0.45em;
        text-wrap: balance;
    }

    .experience-subtitle {
        max-width: 760px;
        margin: 0 auto;
        font-size: clamp(1.02rem, 1.8vw, 1.24rem);
        line-height: 1.78;
        color: #a7b6cb;
    }

    @keyframes experience-float-1 {
        from {
            transform: translate3d(0, 0, 0) scale(1);
        }
        to {
            transform: translate3d(0, -22px, 0) scale(1.03);
        }
    }

    @keyframes experience-hue-pan {
        from {
            transform: rotate(0deg) scale(1.04);
        }
        to {
            transform: rotate(360deg) scale(1.04);
        }
    }

    @media (max-width: 768px) {
        /* Performance: reduce blend/animation cost on mobile GPUs. */
        .experience-bg-2 {
            animation: none;
            mix-blend-mode: normal;
            opacity: 0.42;
        }

        .experience-grain {
            opacity: 0.03;
        }

        .experience {
            padding-top: 8rem;
        }

        .experience-container {
            padding: 0 0.5rem;
            width: 100%;
        }

        .experience-header {
            margin-bottom: 2.5rem;
            padding: 0 1rem;
        }
    }

    @media (prefers-reduced-motion: reduce) {
        .experience-bg-1,
        .experience-bg-2 {
            animation: none;
        }
    }

    @media (hover: none) and (pointer: coarse) {
        /* Performance: ultra-lite background treatment for touch devices. */
        .experience-bg-1,
        .experience-bg-2 {
            animation: none;
            filter: none;
        }

        .experience-bg-2 {
            mix-blend-mode: normal;
            opacity: 0.34;
        }

        .experience-grain {
            opacity: 0.02;
        }
    }
</style>
