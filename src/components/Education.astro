---
import { translations } from "../i18n";

const { lang = "en" } = Astro.props;
const educationData = translations[lang as "en" | "es"].education;
const educationEn = translations.en.education;

type CertItem = {
    title: string;
    issuer: string;
    link?: string;
};

function withFallbackLinks(localized: CertItem[], defaults: CertItem[]) {
    return localized.map((cert, i) => ({
        ...cert,
        link: cert.link?.trim() || defaults[i]?.link || "",
    }));
}

const certsGoogle = withFallbackLinks(
    educationData.certs_google as CertItem[],
    educationEn.certs_google as CertItem[],
);
const certsWeb = withFallbackLinks(
    educationData.certs_web as CertItem[],
    educationEn.certs_web as CertItem[],
);
const certsData = withFallbackLinks(
    educationData.certs_data as CertItem[],
    educationEn.certs_data as CertItem[],
);

function renderLucideIcon(name: string) {
    const icons: Record<string, string> = {
        scroll: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M8 21h8"/><path d="M12 17v4"/><path d="M7 4h10"/><path d="M17 4v8a5 5 0 0 1-10 0V4"/></svg>`,
        code: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="m16 18 6-6-6-6"/><path d="m8 6-6 6 6 6"/></svg>`,
        database: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M3 5v14c0 1.7 4 3 9 3s9-1.3 9-3V5"/><path d="M3 12c0 1.7 4 3 9 3s9-1.3 9-3"/></svg>`,
        mic: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 14a3 3 0 0 0 3-3V6a3 3 0 1 0-6 0v5a3 3 0 0 0 3 3Z"/><path d="M19 11a7 7 0 0 1-14 0"/><path d="M12 18v4"/><path d="M8 22h8"/></svg>`,
        rocket: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M4.5 19.5c1.2-2.4 3.6-3 5.4-3 2.8 0 4.7 1.2 5.8 2.5"/><path d="M14 10 21 3"/><path d="M13 3h8v8"/><circle cx="9" cy="15" r="2.5"/></svg>`,
        globe: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M2 12h20"/><path d="M12 2a15 15 0 0 1 0 20"/><path d="M12 2a15 15 0 0 0 0 20"/></svg>`,
        sparkles: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="m12 3 1.7 3.8L17.5 8.5l-3.8 1.7L12 14l-1.7-3.8L6.5 8.5l3.8-1.7L12 3Z"/><path d="M19 14l.9 2.1L22 17l-2.1.9L19 20l-.9-2.1L16 17l2.1-.9L19 14Z"/><path d="M5 14l.9 2.1L8 17l-2.1.9L5 20l-.9-2.1L2 17l2.1-.9L5 14Z"/></svg>`,
        compass: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m16.2 7.8-2.7 5.4-5.4 2.7 2.7-5.4 5.4-2.7Z"/></svg>`,
        wrench: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M14.7 6.3a4 4 0 0 0 3 5.8L10 19.8l-3.8.9.9-3.8 7.7-7.7a4 4 0 0 0 5.8-3"/></svg>`,
        python: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M9 3h6a4 4 0 0 1 4 4v3H9a2 2 0 0 1-2-2V7a4 4 0 0 1 2-4Z"/><path d="M15 21H9a4 4 0 0 1-4-4v-3h10a2 2 0 0 1 2 2v1a4 4 0 0 1-2 4Z"/><circle cx="15.5" cy="6.5" r=".8" fill="currentColor" stroke="none"/><circle cx="8.5" cy="17.5" r=".8" fill="currentColor" stroke="none"/></svg>`,
        bolt: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2 4 14h7l-1 8 9-12h-7l1-8Z"/></svg>`,
        monitor: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="12" rx="2"/><path d="M8 20h8"/><path d="M12 16v4"/></svg>`,
        book: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2Z"/></svg>`,
        settings: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.7 1.7 0 0 0 .3 1.8l.1.1a2 2 0 1 1-2.8 2.8l-.1-.1a1.7 1.7 0 0 0-1.8-.3 1.7 1.7 0 0 0-1 1.5V21a2 2 0 1 1-4 0v-.2a1.7 1.7 0 0 0-1-1.5 1.7 1.7 0 0 0-1.8.3l-.1.1a2 2 0 1 1-2.8-2.8l.1-.1a1.7 1.7 0 0 0 .3-1.8 1.7 1.7 0 0 0-1.5-1H3a2 2 0 1 1 0-4h.2a1.7 1.7 0 0 0 1.5-1 1.7 1.7 0 0 0-.3-1.8l-.1-.1a2 2 0 1 1 2.8-2.8l.1.1a1.7 1.7 0 0 0 1.8.3h.1A1.7 1.7 0 0 0 10.1 3V3a2 2 0 1 1 4 0v.2a1.7 1.7 0 0 0 1 1.5h.1a1.7 1.7 0 0 0 1.8-.3l.1-.1a2 2 0 1 1 2.8 2.8l-.1.1a1.7 1.7 0 0 0-.3 1.8v.1a1.7 1.7 0 0 0 1.5 1H21a2 2 0 1 1 0 4h-.2a1.7 1.7 0 0 0-1.5 1Z"/></svg>`,
        users: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.9"/><path d="M16 3.1a4 4 0 0 1 0 7.8"/></svg>`,
        puzzle: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M19 13h-2a2 2 0 1 1 0-4h2V5a2 2 0 0 0-2-2h-4v2a2 2 0 1 1-4 0V3H5a2 2 0 0 0-2 2v4h2a2 2 0 1 1 0 4H3v4a2 2 0 0 0 2 2h4v-2a2 2 0 1 1 4 0v2h4a2 2 0 0 0 2-2v-4Z"/></svg>`,
        refresh: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M3 2v6h6"/><path d="M21 22v-6h-6"/><path d="M3.5 13a9 9 0 0 1 14.3-7.3L21 8"/><path d="M20.5 11a9 9 0 0 1-14.3 7.3L3 16"/></svg>`,
        bulb: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.8V16a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-1.2A7 7 0 0 0 12 2Z"/></svg>`,
        award: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="8" r="6"/><path d="M15.5 13.5 18 22l-6-3-6 3 2.5-8.5"/></svg>`,
        timer: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="13" r="8"/><path d="M12 9v4l2.5 1.5"/><path d="M9 2h6"/></svg>`,
        hand: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M7 11V5a1 1 0 0 1 2 0v6"/><path d="M11 11V4a1 1 0 0 1 2 0v7"/><path d="M15 11V6a1 1 0 0 1 2 0v7"/><path d="M19 11a1 1 0 0 1 2 0v3a8 8 0 0 1-16 0v-1a1 1 0 0 1 2 0"/></svg>`,
        brain: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 4a3.5 3.5 0 0 0-3.5 3.5v9A3.5 3.5 0 0 0 9.5 20"/><path d="M14.5 4A3.5 3.5 0 0 1 18 7.5v9a3.5 3.5 0 0 1-3.5 3.5"/><path d="M9.5 9.5H12"/><path d="M12 9.5h2.5"/><path d="M12 4v16"/></svg>`,
        building: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="3" width="16" height="18" rx="2"/><path d="M9 8h1"/><path d="M14 8h1"/><path d="M9 12h1"/><path d="M14 12h1"/><path d="M9 16h6"/></svg>`,
        target: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"/><circle cx="12" cy="12" r="5"/><circle cx="12" cy="12" r="2"/></svg>`,
        scale: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3v18"/><path d="M7 21h10"/><path d="M4 7h16"/><path d="m6 7-3 5h6l-3-5Z"/><path d="m18 7-3 5h6l-3-5Z"/></svg>`,
        message: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a4 4 0 0 1-4 4H8l-5 3V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4Z"/></svg>`,
        trophy: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M8 21h8"/><path d="M12 17v4"/><path d="M7 4h10v3a5 5 0 0 1-10 0V4Z"/><path d="M5 5H3a2 2 0 0 0 2 2"/><path d="M19 5h2a2 2 0 0 1-2 2"/></svg>`,
        pen: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="m12 20 9-9-3-3-9 9-1 4 4-1Z"/><path d="M16 7l3 3"/></svg>`,
        "git-branch": `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="6" r="3"/><circle cx="18" cy="18" r="3"/><circle cx="18" cy="6" r="3"/><path d="M9 6h6"/><path d="M6 9v7a2 2 0 0 0 2 2h7"/></svg>`,
        container: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="7" width="18" height="10" rx="2"/><path d="M8 7v10"/><path d="M16 7v10"/></svg>`,
        send: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M22 2 11 13"/><path d="M22 2 15 22l-4-9-9-4Z"/></svg>`,
        bot: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="8" width="18" height="11" rx="2"/><path d="M7 8V6a5 5 0 0 1 10 0v2"/><path d="M9 13h.01"/><path d="M15 13h.01"/></svg>`,
    };

    return icons[name] || icons.sparkles;
}

const googleMeta = [
    {
        icon: "python",
        link: "https://www.coursera.org/professional-certificates/google-it-automation",
    },
    {
        icon: "bolt",
        link: "https://www.coursera.org/learn/automating-real-world-tasks-python",
    },
    {
        icon: "monitor",
        link: "https://www.coursera.org/learn/python-operating-system",
    },
    { icon: "book", link: "https://www.coursera.org/learn/python-crash-course" },
    {
        icon: "settings",
        link: "https://www.coursera.org/learn/troubleshooting-debugging-techniques",
    },
    {
        icon: "globe",
        link: "https://www.coursera.org/learn/configuration-management-cloud",
    },
];
const webMeta = [
    { icon: "code", link: "" },
    { icon: "bolt", link: "" },
    { icon: "database", link: "" },
    { icon: "settings", link: "" },
    { icon: "sparkles", link: "" },
    { icon: "scroll", link: "" },
];
const dataMeta = [
    { icon: "database", link: "" },
    { icon: "python", link: "" },
    { icon: "python", link: "" },
    { icon: "bolt", link: "" },
    { icon: "sparkles", link: "" },
];

const talkMetadata = [
    {
        icon: "mic",
        link: "https://www.meetup.com/es/pythonbogota/events/248661418/",
        color: "indigo",
    },
];

const langMetadata = [
    { percent: 100, code: "ES" },
    { percent: 80, code: "EN" },
    { percent: 40, code: "DE" },
];

const skillMetadata = [
    { icon: "users" },
    { icon: "puzzle" },
    { icon: "refresh" },
    { icon: "bulb" },
    { icon: "award" },
    { icon: "timer" },
    { icon: "hand" },
    { icon: "brain" },
    { icon: "book" },
    { icon: "building" },
];

const biasMetadata = [
    { icon: "target" },
    { icon: "scale" },
    { icon: "message" },
    { icon: "bolt" },
    { icon: "trophy" },
];

const activityIcons = ["globe", "pen", "mic"];
const toolIcons = [
    "monitor",
    "git-branch",
    "container",
    "send",
    "book",
    "bot",
];
---

<section class="education zoom-section" id="education">
    <div class="zoom-bg education-bg"></div>
    <div class="container zoom-content">
        <div class="education-header reveal">
            <p class="section-label" data-i18n="education.label">Credentials</p>
            <h2 class="section-title" data-i18n="education.title">
                Education & <span class="gradient-text">Recognition</span>
            </h2>
            <p class="section-subtitle" data-i18n="education.subtitle">
                A lifetime of learning, from professional certificates to
                international speaking.
            </p>
        </div>

        <div class="education-grid">
            <!-- Certifications Column -->
            <div class="edu-column reveal-left">
                <h3 class="edu-column-title">
                    <span class="edu-icon" aria-hidden="true" set:html={renderLucideIcon("scroll")}></span>
                    <span data-i18n="education.cert_title"
                        >Professional Certifications</span
                    >
                </h3>

                <!-- Google IT Automation Sub-group -->
                <div class="cert-group">
                    <h4 class="cert-group-title">
                        <span class="cert-group-icon" aria-hidden="true" set:html={renderLucideIcon("python")}></span>
                        <span data-i18n="education.google_title"
                            >Google IT Automation</span
                        >
                        <span class="cert-count">{certsGoogle.length}</span>
                    </h4>
                    {
                        certsGoogle[0]?.link && (
                            <a
                                href={certsGoogle[0].link}
                                data-i18n-href="education.certs_google.0.link"
                                data-hide-if-empty-href
                                target="_blank"
                                rel="noopener noreferrer"
                                class="featured-cert-badge-link"
                                aria-label="View Google IT Automation badge"
                            >
                                <img
                                    src="/images/certificate/GCC_badge_python.png"
                                    alt="Google IT Automation with Python Professional Certificate badge"
                                    class="featured-cert-badge"
                                    loading="lazy"
                                    decoding="async"
                                />
                            </a>
                        )
                    }
                    <div class="certifications-list stagger-children">
                        {
                            certsGoogle.map((cert, i) => (
                                <div
                                    class={`edu-card glass-card ${i === 0 ? "cert-main" : ""}`}
                                >
                                    <span class="edu-card-icon" aria-hidden="true" set:html={renderLucideIcon(googleMeta[i]?.icon || "scroll")}></span>
                                    <div class="edu-card-content">
                                        <strong
                                            data-i18n={`education.certs_google.${i}.title`}
                                        >
                                            {cert.title}
                                        </strong>
                                        <p
                                            class="edu-issuer"
                                            data-i18n={`education.certs_google.${i}.issuer`}
                                        >
                                            {cert.issuer}
                                        </p>
                                    </div>
                                    {cert.link && (
                                        <a
                                            href={cert.link}
                                            data-i18n-href={`education.certs_google.${i}.link`}
                                            data-hide-if-empty-href
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            class="cert-link"
                                            aria-label="View Certification"
                                        >
                                            <svg
                                                width="18"
                                                height="18"
                                                viewBox="0 0 24 24"
                                                fill="none"
                                                stroke="currentColor"
                                                stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                            >
                                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                                                <polyline points="15 3 21 3 21 9" />
                                                <line
                                                    x1="10"
                                                    y1="14"
                                                    x2="21"
                                                    y2="3"
                                                />
                                            </svg>
                                        </a>
                                    )}
                                </div>
                            ))
                        }
                    </div>
                </div>

                <!-- Web Development Sub-group -->
                <div class="cert-group">
                    <h4 class="cert-group-title">
                        <span class="cert-group-icon" aria-hidden="true" set:html={renderLucideIcon("code")}></span>
                        <span data-i18n="education.web_title"
                            >Web Development</span
                        >
                        <span class="cert-count">{certsWeb.length}</span>
                    </h4>
                    <div class="certifications-list stagger-children">
                        {
                            certsWeb.map((cert, i) => (
                                <div class="edu-card glass-card">
                                    <span class="edu-card-icon" aria-hidden="true" set:html={renderLucideIcon(webMeta[i]?.icon || "scroll")}></span>
                                    <div class="edu-card-content">
                                        <strong
                                            data-i18n={`education.certs_web.${i}.title`}
                                        >
                                            {cert.title}
                                        </strong>
                                        <p
                                            class="edu-issuer"
                                            data-i18n={`education.certs_web.${i}.issuer`}
                                        >
                                            {cert.issuer}
                                        </p>
                                    </div>
                                    {cert.link && (
                                        <a
                                            href={cert.link}
                                            data-i18n-href={`education.certs_web.${i}.link`}
                                            data-hide-if-empty-href
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            class="cert-link"
                                            aria-label="View Certification"
                                        >
                                            <svg
                                                width="18"
                                                height="18"
                                                viewBox="0 0 24 24"
                                                fill="none"
                                                stroke="currentColor"
                                                stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                            >
                                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                                                <polyline points="15 3 21 3 21 9" />
                                                <line
                                                    x1="10"
                                                    y1="14"
                                                    x2="21"
                                                    y2="3"
                                                />
                                            </svg>
                                        </a>
                                    )}
                                </div>
                            ))
                        }
                    </div>
                </div>

                <!-- Data & Languages Sub-group -->
                <div class="cert-group">
                    <h4 class="cert-group-title">
                        <span class="cert-group-icon" aria-hidden="true" set:html={renderLucideIcon("database")}></span>
                        <span data-i18n="education.data_title"
                            >Data & Languages</span
                        >
                        <span class="cert-count">{certsData.length}</span>
                    </h4>
                    <div class="certifications-list stagger-children">
                        {
                            certsData.map((cert, i) => (
                                <div class="edu-card glass-card">
                                    <span class="edu-card-icon" aria-hidden="true" set:html={renderLucideIcon(dataMeta[i]?.icon || "scroll")}></span>
                                    <div class="edu-card-content">
                                        <strong
                                            data-i18n={`education.certs_data.${i}.title`}
                                        >
                                            {cert.title}
                                        </strong>
                                        <p
                                            class="edu-issuer"
                                            data-i18n={`education.certs_data.${i}.issuer`}
                                        >
                                            {cert.issuer}
                                        </p>
                                    </div>
                                    {cert.link && (
                                        <a
                                            href={cert.link}
                                            data-i18n-href={`education.certs_data.${i}.link`}
                                            data-hide-if-empty-href
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            class="cert-link"
                                            aria-label="View Certification"
                                        >
                                            <svg
                                                width="18"
                                                height="18"
                                                viewBox="0 0 24 24"
                                                fill="none"
                                                stroke="currentColor"
                                                stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                            >
                                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                                                <polyline points="15 3 21 3 21 9" />
                                                <line
                                                    x1="10"
                                                    y1="14"
                                                    x2="21"
                                                    y2="3"
                                                />
                                            </svg>
                                        </a>
                                    )}
                                </div>
                            ))
                        }
                    </div>
                </div>
            </div>

            <!-- Right Column: Speaking, Languages, Skills, Toolset, Activities, Bias -->
            <div class="edu-column reveal-right">
                <!-- Speaking & Community -->
                <h3 class="edu-column-title">
                    <span class="edu-icon" aria-hidden="true" set:html={renderLucideIcon("mic")}></span>
                    <span data-i18n="education.speaking_title"
                        >Speaking & Community</span
                    >
                </h3>
                {
                    educationData.talks.map((_, i) => (
                        <div
                            class="edu-card glass-card talk-card"
                            style={`border-left-color: var(--accent-${talkMetadata[i]?.color || "indigo"})`}
                        >
                            <span class="edu-card-icon" aria-hidden="true" set:html={renderLucideIcon(talkMetadata[i]?.icon || "mic")}></span>
                            <div class="edu-card-content">
                                <strong
                                    data-i18n={`education.talks.${i}.title`}
                                />
                                <p
                                    class="edu-issuer"
                                    data-i18n={`education.talks.${i}.venue`}
                                />
                            </div>
                            {talkMetadata[i]?.link && (
                                <a
                                    href={talkMetadata[i].link}
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    class="btn btn-outline talk-btn"
                                    data-i18n="education.view_talk"
                                >
                                    View Talk
                                </a>
                            )}
                        </div>
                    ))
                }

                <!-- Activities & Community -->
                <h3 class="edu-column-title" style="margin-top: 2.5rem;">
                    <span class="edu-icon" aria-hidden="true" set:html={renderLucideIcon("rocket")}></span>
                    <span data-i18n="education.activities_title"
                        >Activities & Community</span
                    >
                </h3>
                <div class="activities-list">
                    {
                        educationData.activities.map((activity, i) => (
                            <span class="activity-tag">
                                <span class="activity-icon" aria-hidden="true" set:html={renderLucideIcon(activityIcons[i] || "sparkles")}></span>
                                <span
                                    data-i18n={`education.activities.${i}.name`}
                                >
                                    {activity.name}
                                </span>
                            </span>
                        ))
                    }
                </div>

                <!-- Languages -->
                <h3 class="edu-column-title" style="margin-top: 2.5rem;">
                    <span class="edu-icon" aria-hidden="true" set:html={renderLucideIcon("globe")}></span>
                    <span data-i18n="education.languages_title">Languages</span>
                </h3>
                <div class="languages-list">
                    {
                        educationData.languages.map((_, i) => (
                            <div class="lang-item">
                                <div class="lang-info">
                                    <span class="lang-flag">
                                        {langMetadata[i]?.code || "--"}
                                    </span>
                                    <span
                                        class="lang-name"
                                        data-i18n={`education.languages.${i}.name`}
                                    />
                                    <span
                                        class="lang-level"
                                        data-i18n={`education.languages.${i}.level`}
                                    />
                                </div>
                                <div class="lang-bar">
                                    <div
                                        class="lang-progress"
                                        style={`--progress: ${langMetadata[i]?.percent}%`}
                                    />
                                </div>
                            </div>
                        ))
                    }
                </div>

                <!-- Core Competencies -->
                <h3 class="edu-column-title" style="margin-top: 2.5rem;">
                    <span class="edu-icon" aria-hidden="true" set:html={renderLucideIcon("sparkles")}></span>
                    <span data-i18n="education.competencies_title"
                        >Core Competencies</span
                    >
                </h3>
                <div class="soft-skills">
                    {
                        educationData.softSkills.map((_, i) => (
                            <span class="soft-tag">
                                <span class="soft-icon" aria-hidden="true" set:html={renderLucideIcon(skillMetadata[i]?.icon || "sparkles")}></span>
                                <span
                                    data-i18n={`education.softSkills.${i}.name`}
                                />
                            </span>
                        ))
                    }
                </div>

                <!-- Dominant Bias / Work Philosophy -->
                <h3 class="edu-column-title" style="margin-top: 2.5rem;">
                    <span class="edu-icon" aria-hidden="true" set:html={renderLucideIcon("compass")}></span>
                    <span data-i18n="education.work_philosophy_title">Work Philosophy</span>
                </h3>
                <div class="bias-list">
                    {
                        educationData.dominantBias.map((bias, i) => (
                            <span class="bias-tag">
                                <span class="bias-icon" aria-hidden="true" set:html={renderLucideIcon(biasMetadata[i]?.icon || "target")}></span>
                                <span
                                    data-i18n={`education.dominantBias.${i}.name`}
                                >
                                    {bias.name}
                                </span>
                            </span>
                        ))
                    }
                </div>

                <!-- Everyday Toolset -->
                <h3 class="edu-column-title" style="margin-top: 2.5rem;">
                    <span class="edu-icon" aria-hidden="true" set:html={renderLucideIcon("wrench")}></span>
                    <span data-i18n="education.toolset_title"
                        >Everyday Toolset</span
                    >
                </h3>
                <div class="toolset-grid">
                    {
                        educationData.toolset.map((tool, i) => (
                            <div class="tool-card glass-card">
                                <span class="tool-icon" aria-hidden="true" set:html={renderLucideIcon(toolIcons[i] || "wrench")}></span>
                                <span
                                    class="tool-name"
                                    data-i18n={`education.toolset.${i}.name`}
                                >
                                    {tool.name}
                                </span>
                            </div>
                        ))
                    }
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    function teardownEducationAnimation() {
        const runtime = ((window as any).__cvRuntime ||= {});
        if (runtime.educationLangObserver) {
            runtime.educationLangObserver.disconnect();
            runtime.educationLangObserver = null;
        }
    }

    function initEducationAnimation() {
        teardownEducationAnimation();

        const runtime = ((window as any).__cvRuntime ||= {});
        const observer = new IntersectionObserver(
            (entries) => {
                entries.forEach((entry) => {
                    if (!entry.isIntersecting) return;

                    const bars = entry.target.querySelectorAll(".lang-progress");
                    bars.forEach((bar, i) => {
                        const htmlBar = bar as HTMLElement;
                        setTimeout(() => {
                            htmlBar.style.width = htmlBar.style.getPropertyValue("--progress");
                        }, i * 150);
                    });

                    observer.unobserve(entry.target);
                });
            },
            { threshold: 0.3 },
        );

        runtime.educationLangObserver = observer;

        document
            .querySelectorAll(".languages-list")
            .forEach((el) => observer.observe(el));
    }

    initEducationAnimation();
    document.addEventListener("astro:after-swap", initEducationAnimation);
    document.addEventListener("astro:before-swap", teardownEducationAnimation);
</script>

<style>
    .education {
        padding: var(--section-padding) 0;
        position: relative;
    }

    .education-header {
        text-align: center;
        margin-bottom: 2.6rem;
    }

    .education-grid {
        display: grid;
        grid-template-columns: 1.1fr 0.9fr;
        gap: 2.2rem;
    }

    /* ── Cert Groups ── */
    .cert-group {
        margin-bottom: 1.3rem;
    }

    .cert-group-title {
        display: flex;
        align-items: center;
        gap: 0.6rem;
        font-size: 0.95rem;
        font-weight: 700;
        color: var(--text-secondary);
        margin-bottom: 0.75rem;
        padding-bottom: 0.5rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.06);
    }

    .cert-group-icon {
        width: 18px;
        height: 18px;
        color: var(--accent-blue);
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }

    .cert-group-icon :global(svg) {
        width: 18px;
        height: 18px;
    }

    .cert-count {
        margin-left: auto;
        background: rgba(56, 189, 248, 0.1);
        color: var(--accent-blue);
        padding: 0.15rem 0.6rem;
        border-radius: 50px;
        font-size: 0.7rem;
        font-family: var(--font-mono);
        font-weight: 700;
        letter-spacing: 0.05em;
    }

    .cert-main {
        border-left: 3px solid var(--accent-blue);
        background: rgba(56, 189, 248, 0.04) !important;
    }

    .featured-cert-badge-link {
        display: inline-flex;
        margin: 0 0 1rem;
        border-radius: 999px;
        position: relative;
        z-index: 2;
        transition: transform 0.25s ease;
        overflow: visible;
    }

    .featured-cert-badge {
        width: 86px;
        height: 86px;
        border-radius: 999px;
        border: 2px solid rgba(56, 189, 248, 0.45);
        box-shadow: 0 10px 20px rgba(56, 189, 248, 0.24);
        transition:
            transform 0.25s ease,
            box-shadow 0.25s ease;
        transform-origin: left center;
    }

    .featured-cert-badge-link:hover {
        transform: translateY(-4px);
        z-index: 30;
    }

    .featured-cert-badge-link:hover .featured-cert-badge {
        transform: scale(2.2) rotate(-4deg);
        box-shadow: 0 20px 42px rgba(56, 189, 248, 0.35);
    }

    /* ── Shared ── */
    .edu-column-title {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-size: 1.25rem;
        font-weight: 800;
        margin-bottom: 1rem;
        color: var(--text-primary);
    }

    .edu-icon {
        width: 24px;
        height: 24px;
        color: var(--accent-blue);
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }

    .edu-icon :global(svg) {
        width: 22px;
        height: 22px;
    }

    .edu-card {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 0.75rem 0.85rem;
        margin-bottom: 0.5rem;
        position: relative;
        transition: all 0.3s ease;
    }

    .edu-card:hover {
        transform: translateX(4px);
        background: rgba(255, 255, 255, 0.03);
    }

    .talk-card {
        border-left: 4px solid var(--accent-indigo);
    }

    .edu-card-icon {
        width: 28px;
        height: 28px;
        color: #7dd3fc;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }

    .edu-card-icon :global(svg) {
        width: 18px;
        height: 18px;
    }

    .edu-card-content {
        flex: 1;
    }

    .edu-card strong {
        display: block;
        margin-bottom: 0.15rem;
        font-size: 0.85rem;
        line-height: 1.4;
    }

    .edu-issuer {
        color: var(--accent-blue);
        font-size: 0.7rem;
        font-family: var(--font-mono);
        font-weight: 600;
    }

    .cert-link {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 38px;
        height: 38px;
        border-radius: 50%;
        border: 1px solid rgba(56, 189, 248, 0.3);
        background: rgba(56, 189, 248, 0.08);
        color: var(--accent-blue);
        flex-shrink: 0;
        opacity: 0.95;
        transition: all 0.25s ease;
    }

    .cert-link svg {
        width: 20px;
        height: 20px;
        display: block;
    }

    .cert-link:hover {
        color: #fff;
        opacity: 1;
        transform: scale(1.14);
        background: rgba(56, 189, 248, 0.25);
        border-color: rgba(56, 189, 248, 0.6);
        box-shadow: 0 8px 18px rgba(56, 189, 248, 0.28);
    }

    @media (max-width: 480px) {
        .featured-cert-badge {
            width: 74px;
            height: 74px;
        }

        .featured-cert-badge-link:hover .featured-cert-badge {
            transform: scale(1.45);
        }
    }

    .talk-btn {
        padding: 0.5rem 1rem;
        font-size: 0.75rem;
        white-space: nowrap;
    }

    /* ── Activities ── */
    .activities-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.45rem;
    }

    .activity-tag {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.48rem 0.85rem;
        border-radius: 50px;
        background: linear-gradient(
            135deg,
            rgba(56, 189, 248, 0.08),
            rgba(34, 211, 238, 0.08)
        );
        border: 1px solid rgba(56, 189, 248, 0.15);
        color: var(--text-secondary);
        font-size: 0.85rem;
        font-weight: 600;
        transition: all 0.3s;
    }

    .activity-tag:hover {
        background: linear-gradient(
            135deg,
            rgba(56, 189, 248, 0.15),
            rgba(34, 211, 238, 0.15)
        );
        border-color: rgba(56, 189, 248, 0.4);
        color: var(--text-primary);
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(56, 189, 248, 0.1);
    }

    .activity-icon {
        width: 16px;
        height: 16px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: var(--accent-blue);
    }

    .activity-icon :global(svg) {
        width: 15px;
        height: 15px;
    }

    /* ── Languages ── */
    .lang-item {
        margin-bottom: 0.9rem;
    }

    .lang-info {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 0.5rem;
    }

    .lang-flag {
        min-width: 34px;
        height: 22px;
        border-radius: 999px;
        border: 1px solid rgba(56, 189, 248, 0.28);
        background: rgba(56, 189, 248, 0.1);
        color: #bae6fd;
        font-size: 0.68rem;
        font-weight: 700;
        letter-spacing: 0.07em;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }

    .lang-name {
        font-weight: 700;
        font-size: 0.95rem;
    }

    .lang-level {
        font-family: var(--font-mono);
        font-size: 0.75rem;
        color: var(--text-muted);
        margin-left: auto;
    }

    .lang-bar {
        height: 10px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 5px;
        overflow: hidden;
    }

    .lang-progress {
        height: 100%;
        width: 0;
        border-radius: 5px;
        background: var(--gradient-primary);
        transition: width 1.5s cubic-bezier(0.16, 1, 0.3, 1);
        position: relative;
    }

    .lang-progress::after {
        content: "";
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        width: 20px;
        background: linear-gradient(
            90deg,
            transparent,
            rgba(255, 255, 255, 0.2)
        );
    }

    /* ── Soft Skills ── */
    .soft-skills {
        display: flex;
        flex-wrap: wrap;
        gap: 0.4rem;
    }

    .soft-tag {
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        padding: 0.5rem 1rem;
        border-radius: 50px;
        background: rgba(56, 189, 248, 0.07);
        border: 1px solid rgba(56, 189, 248, 0.12);
        color: var(--text-secondary);
        font-size: 0.8rem;
        font-weight: 600;
        transition: all 0.3s;
    }

    .soft-icon,
    .bias-icon {
        width: 14px;
        height: 14px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: var(--text-primary);
    }

    .soft-icon :global(svg),
    .bias-icon :global(svg) {
        width: 14px;
        height: 14px;
    }

    .soft-tag:hover {
        background: rgba(56, 189, 248, 0.13);
        border-color: rgba(56, 189, 248, 0.32);
        color: var(--text-primary);
        transform: translateY(-3px);
    }

    /* ── Dominant Bias / Work Philosophy ── */
    .bias-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.4rem;
    }

    .bias-tag {
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        padding: 0.5rem 1rem;
        border-radius: 50px;
        background: linear-gradient(
            135deg,
            rgba(251, 191, 36, 0.06),
            rgba(251, 146, 60, 0.06)
        );
        border: 1px solid rgba(251, 191, 36, 0.12);
        color: var(--text-secondary);
        font-size: 0.8rem;
        font-weight: 600;
        transition: all 0.3s;
    }

    .bias-tag:hover {
        background: linear-gradient(
            135deg,
            rgba(251, 191, 36, 0.15),
            rgba(251, 146, 60, 0.15)
        );
        border-color: rgba(251, 191, 36, 0.4);
        color: var(--text-primary);
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(251, 191, 36, 0.1);
    }

    /* ── Everyday Toolset ── */
    .toolset-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 0.6rem;
    }

    .tool-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
        padding: 1rem 0.5rem;
        text-align: center;
        transition: all 0.3s ease;
    }

    .tool-card:hover {
        transform: translateY(-5px) scale(1.03);
        box-shadow:
            0 12px 24px rgba(0, 0, 0, 0.3),
            0 0 15px rgba(56, 189, 248, 0.08);
    }

    .tool-icon {
        width: 24px;
        height: 24px;
        color: var(--accent-blue);
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }

    .tool-icon :global(svg) {
        width: 20px;
        height: 20px;
        filter: drop-shadow(0 0 6px rgba(56, 189, 248, 0.2));
    }

    .tool-name {
        font-size: 0.7rem;
        font-weight: 700;
        color: var(--text-secondary);
        line-height: 1.3;
    }

    /* ── Responsive ── */
    @media (max-width: 1024px) {
        .education-grid {
            grid-template-columns: 1fr;
            gap: 3rem;
        }
    }

    @media (max-width: 480px) {
        .edu-card {
            padding: 0.75rem;
        }
        .talk-btn {
            display: none;
        }
        .toolset-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 430px) {
        .education-header {
            margin-bottom: 1.7rem;
        }

        .education-grid {
            gap: 1.7rem;
        }

        .edu-column-title {
            font-size: 1.08rem;
            gap: 0.6rem;
            margin-bottom: 0.75rem;
        }

        .cert-group {
            margin-bottom: 0.95rem;
        }

        .cert-group-title {
            font-size: 0.86rem;
            margin-bottom: 0.55rem;
        }

        .edu-card {
            gap: 0.72rem;
            padding: 0.66rem 0.7rem;
            margin-bottom: 0.4rem;
        }

        .edu-card strong {
            font-size: 0.8rem;
        }

        .edu-issuer {
            font-size: 0.66rem;
        }

        .cert-link {
            width: 34px;
            height: 34px;
        }

        .activities-list,
        .soft-skills,
        .bias-list {
            gap: 0.32rem;
        }

        .activity-tag,
        .soft-tag,
        .bias-tag {
            padding: 0.4rem 0.68rem;
            font-size: 0.75rem;
        }

        .tool-card {
            padding: 0.7rem 0.45rem;
            gap: 0.35rem;
        }
    }
</style>
